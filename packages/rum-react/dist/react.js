import*as a from'react';import {jsx}from'react/jsx-runtime';var g=new Map,h=1e4,E=500,S=2e3,p=class extends a.Component{constructor(){super(...arguments);this.state={err:null,info:null};this.reset=(e="api",r,o)=>{this.setState({err:null,info:null},()=>{this.props.onReset?.(e,r,o);});};}static getDerivedStateFromError(e){return {err:e}}componentDidCatch(e,r){this.setState({info:r});let{track:o,client:s,dedupWindowMs:c,maxMessageLen:u,maxStackLen:k}=this.props,d=c??h,R=u??E,f=k??S,i={type:"react-error",message:l(String(e?.name?`${e.name}: ${e.message}`:e?.message||String(e)),R),stack:l(String(e?.stack||""),f),componentStack:l(r?.componentStack||"",f)},y=C(`${i.message}|${m(i.stack,5)}|${m(i.componentStack,3)}`).toString(36);M(g,y,d)||(o??s?.track)?.(i),this.props.onError?.(e,r);}componentDidUpdate(e){let{resetKeys:r}=this.props;if(this.state.err&&r&&!w(e.resetKeys,r)){let o=e.resetKeys,s=r;this.reset("keys",o,s);}}render(){let{err:e}=this.state;if(e){let r=()=>this.reset("api"),{FallbackComponent:o,fallbackRender:s,fallback:c}=this.props;return typeof s=="function"?s({error:e,reset:r}):o?jsx(o,{error:e,reset:r}):c??null}return this.props.children}};function w(t,n){if(t===n)return  true;if(!t||!n||t.length!==n.length)return  false;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return  false;return  true}function l(t,n){return t.length>n?t.slice(0,n):t}function m(t,n=5){return (t||"").split(`
`).slice(0,n).join(`
`)}function C(t){let n=5381,e=t.length;for(;e;)n=n*33^t.charCodeAt(--e);return n>>>0}function M(t,n,e){let r=Date.now(),o=t.get(n)||0;if(r-o<e)return  true;if(t.set(n,r),t.size>300){let s=r-e*2;for(let[c,u]of t)u<s&&t.delete(c);}return  false}export{p as RumErrorBoundary};